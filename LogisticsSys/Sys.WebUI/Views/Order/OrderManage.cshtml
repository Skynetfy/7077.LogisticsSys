@using Sys.WebUI.Models
@{
    Layout = null;
}
<div class="row">
    <div class="col-md-3 complementary" role="complementary">
        <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix-top">
            <ul class="nav bs-docs-sidenav">
                @Html.LeftMeunHtmlString("订单管理", "订单处理", User.Identity.Name)
            </ul>
        </nav>
    </div>
    <div class="col-md-9 maincontent" role="main">
        <h4 id="breadcrumbs" class="page-header">订单处理</h4>
        <div id="toolbar">

            <div class="form-inline" role="form">
                <div class="form-group">
                    <span>状态: </span>
                    <select class="form-control" style="width: initial;" name="orderstatus">
                        @Html.BindingOrderStatusSelectHtmlString()
                    </select>
                    <input type="text" class="form-control" id="orderdate" name="orderdate" placeholder="日期段" style="width: initial;" />
                </div>
                <button id="ok" type="submit" class="btn btn-default">查询</button>
                <button type="button" class="btn btn-success" id="fahuobtn" data-toggle="modal" data-target="#fahuoModel" onclick="fahuodate()" disabled>发货</button>
            </div>
        </div>
        <table id="table"
               data-toggle="table"
               data-toolbar="#toolbar"
               data-show-refresh="true"
               data-show-toggle="true"
               data-search="true"
               data-url="@Url.Action("GetOrderViewPagerData")"
               data-pagination="true"
               data-side-pagination="server"
               data-sort-name="CreateDate"
               data-sort-order="desc"
               data-query-params="queryParams"
               data-page-size="10"
               data-page-list="[10,50,100]"
               data-pagination-first-text="首页"
               data-pagination-pre-text="上一页"
               data-pagination-next-text="下一页"
               data-pagination-last-text="尾页">
            <thead>
                <tr>
                    <th data-field="stats" data-formatter="checkboxstateFormatter" data-checkbox="true"></th>
                    <th data-field="OrderNo" data-formatter="OrderNoFormatter">订单编号</th>
                    @*<th data-field="ShipperName">寄件人</th>*@
                    <th data-field="OrderNumbers">网站订单号</th>
                    <th data-field="DisplayName">下单人</th>
                    <th data-field="CreateDate">下单时间</th>
                    <th data-field="Status" data-formatter="stateFormatter">状态</th>
                    <th data-field="Status" data-formatter="paystateFormatter">付款状态</th>
                    <th data-field="Id" data-formatter="actionFormatter">操作</th>
                </tr>
            </thead>
        </table>
    </div>
</div>

<div class="modal fade" id="ViewModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">

            <div class="modal-body">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">主订单信息</a></li>
                    <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">收件信息</a></li>
                    <li role="presentation"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">寄件信息</a></li>
                    <li role="presentation"><a href="#fahuotab" aria-controls="fahuotab" role="tab" data-toggle="tab">发货信息</a></li>
                    <li role="presentation"><a href="#fukuantab" aria-controls="fukuantab" role="tab" data-toggle="tab">付款信息</a></li>
                </ul>

                <!-- Tab panes -->
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="home">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <th style="width:30%">订单号：</th>
                                    <td><span id="orderno"></span></td>
                                </tr>
                                <tr>
                                    <th>寄件人姓名：</th>
                                    <td><span id="jjxm"></span></td>
                                </tr>
                                <tr>
                                    <th>寄件人电话：</th>
                                    <td><span id="jjdh"></span></td>
                                </tr>
                                <tr>
                                    <th>收货人数量：</th>
                                    <td><span id="shrshl"></span></td>
                                </tr>
                                <tr>
                                    <th>订单状态：</th>
                                    <td><span id="ddzt"></span></td>
                                </tr>
                                <tr>
                                    <th>付款状态：</th>
                                    <td><span id="fkzt"></span></td>
                                </tr>
                                <tr>
                                    <th>下单人：</th>
                                    <td><span id="xdr"></span></td>
                                </tr>
                                <tr>
                                    <th>下单时间：</th>
                                    <td><span id="xdsj"></span></td>
                                </tr>
                                <tr>
                                    <th>订单实际价格：</th>
                                    <td>
                                        <span id="sjjg"></span>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="profile">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <th style="width:30%">俄罗斯城市：</th>
                                    <td><span id="elscs"></span></td>
                                </tr>
                                <tr>
                                    <th>俄罗斯详细地址：</th>
                                    <td><span id="elsdz"></span></td>
                                </tr>
                                <tr>
                                    <th>物流单号：</th>
                                    <td><span id="wldh"></span></td>
                                </tr>
                                <tr>
                                    <th>货物箱数：</th>
                                    <td><span id="hwxs"></span></td>
                                </tr>
                                <tr>
                                    <th>取货时间：</th>
                                    <td><span id="qhsj"></span></td>
                                </tr>
                                <tr>
                                    <th>取货方式：</th>
                                    <td><span id="qhfs"></span></td>
                                </tr>
                                <tr>
                                    <th>货物类型：</th>
                                    <td><span id="hwlx"></span></td>
                                </tr>
                                <tr>
                                    <th>货物运输类型：</th>
                                    <td><span id="hwyslx"></span></td>
                                </tr>
                                <tr>
                                    <th>保价价值(元)：</th>
                                    <td><span id="bjjg"></span></td>
                                </tr>
                                <tr>
                                    <th>保单费用(元)：</th>
                                    <td><span id="bdfy"></span></td>
                                </tr>
                                <tr>
                                    <th>货物重量(kg)：</th>
                                    <td><span id="hwzl"></span></td>
                                </tr>
                                <tr>
                                    <th>货物实际重量：</th>
                                    <td>
                                        <span id="hwsjzl"></span>

                                    </td>
                                </tr>
                                <tr>
                                    <th>货物实际体积重量：</th>
                                    <td>
                                        <span id="hwsjtjzl"></span>

                                    </td>
                                </tr>
                                <tr>
                                    <th>箱子外包装总体积：</th>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        长(cm)：<span id="chang"></span>,
                                        宽(cm)：<span id="kuan"></span>,
                                        高(cm)：<span id="gao"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <th>订单实际价格 (元)：</th>
                                    <td>
                                        <span id="ddsjjg"></span>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="messages">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <th style="width:30%">包裹编号：</th>
                                    <td><span id="bgbh"></span></td>
                                </tr>
                                <tr>
                                    <th>订单省份：</th>
                                    <td><span id="ddsf"></span></td>
                                </tr>
                                <tr>
                                    <th>订单详细地址：</th>
                                    <td><span id="ddxxdz"></span></td>
                                </tr>
                                <tr>
                                    <th>收件人姓名：</th>
                                    <td><span id="sjrxm"></span></td>
                                </tr>
                                <tr>
                                    <th>收件人电话 ：</th>
                                    <td><span id="sjrdh"></span></td>
                                </tr>
                                <tr>
                                    <th>打包方式 ：</th>
                                    <td><span id="dbfs"></span></td>
                                </tr>
                                <tr>
                                    <th>快递方式：</th>
                                    <td><span id="kdfs"></span></td>
                                </tr>
                                <tr>
                                    <th>货物明细 ：</th>
                                    <td><span id="hwmx"></span></td>
                                </tr>
                                <tr>
                                    <th>包裹重量(千克)：</th>
                                    <td><span id="bgzl"></span></td>
                                </tr>
                                <tr>
                                    <th>实际重量(千克)：</th>
                                    <td><span id="csjzl"></span></td>
                                </tr>
                                <tr>
                                    <th>实际价格(元)：</th>
                                    <td><span id="csjjg"></span></td>
                                </tr>
                                <tr>
                                    <th>国内快递单号：</th>
                                    <td><span id="gnkddh"></span></td>
                                </tr>
                                <tr>
                                    <th>备注：</th>
                                    <td><span id="bz"></span></td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="fukuantab">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <th style="width:30%">付款人：</th>
                                    <td><span id="fukuanren"></span></td>
                                </tr>
                                <tr>
                                    <th>付款时间：</th>
                                    <td><span id="fukuanxiangqing"></span></td>
                                </tr>
                                <tr>
                                    <th>付款详情：</th>
                                    <td><span id="fukuanxiangqing"></span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="fahuotab">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <th style="width:30%">发货人：</th>
                                    <td><span id="fahuoren"></span></td>
                                </tr>
                                <tr>
                                    <th>发货时间：</th>
                                    <td><span id="fahuoshijian"></span></td>
                                </tr>
                                <tr>
                                    <th>发货详情：</th>
                                    <td><span id="fahuoxiangqing"></span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="EditModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">

            <div class="modal-body">
                <div id="alert-infor" class="alert alert-success alert-dismissible" role="alert" style="display: none;">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <strong>错误!</strong>
                    <label></label>
                </div>
                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#home1" aria-controls="home1" role="tab" data-toggle="tab">主订单信息</a></li>
                    <li role="presentation"><a href="#profile1" aria-controls="profile1" role="tab" data-toggle="tab">收件信息</a></li>
                    <li role="presentation"><a href="#messages1" aria-controls="messages1" role="tab" data-toggle="tab">寄件信息</a></li>
                </ul>
                <form method="post" id="editorderform" action="@Url.Action("EditOrder")" data-parsley-validate>
                    <input type="hidden" name="orderId" />
                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="home1">
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <th style="width: 30%">订单号：</th>
                                        <td><span data-id="orderno"></span></td>
                                    </tr>
                                    <tr>
                                        <th>寄件人姓名：</th>
                                        <td><span data-id="jjxm"></span></td>
                                    </tr>
                                    <tr>
                                        <th>寄件人电话：</th>
                                        <td><span data-id="jjdh"></span></td>
                                    </tr>
                                    <tr>
                                        <th>收货人数量：</th>
                                        <td><span data-id="shrshl"></span></td>
                                    </tr>
                                    <tr>
                                        <th>订单状态：</th>
                                        <td><span data-id="ddzt"></span></td>
                                    </tr>
                                    <tr>
                                        <th>下单人：</th>
                                        <td><span data-id="xdr"></span></td>
                                    </tr>
                                    <tr>
                                        <th>下单时间：</th>
                                        <td><span data-id="xdsj"></span></td>
                                    </tr>
                                    <tr>
                                        <th>订单实际价格：</th>
                                        <td><input type="text" name="sjjg" data-id="sjjg" required="required" data-parsley-type="number" /></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="profile1">
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <th style="width: 30%">俄罗斯城市：</th>
                                        <td><span data-id="elscs"></span></td>
                                    </tr>
                                    <tr>
                                        <th>俄罗斯详细地址：</th>
                                        <td><span data-id="elsdz"></span></td>
                                    </tr>
                                    <tr>
                                        <th>物流单号：</th>
                                        <td><span data-id="wldh"></span></td>
                                    </tr>
                                    <tr>
                                        <th>货物箱数：</th>
                                        <td><span data-id="hwxs"></span></td>
                                    </tr>
                                    <tr>
                                        <th>取货时间：</th>
                                        <td><span data-id="qhsj"></span></td>
                                    </tr>
                                    <tr>
                                        <th>取货方式：</th>
                                        <td><span data-id="qhfs"></span></td>
                                    </tr>
                                    <tr>
                                        <th>货物类型：</th>
                                        <td><span data-id="hwlx"></span></td>
                                    </tr>
                                    <tr>
                                        <th>货物运输类型：</th>
                                        <td><span data-id="hwyslx"></span></td>
                                    </tr>
                                    <tr>
                                        <th>保价价值(元)：</th>
                                        <td><span data-id="bjjg"></span></td>
                                    </tr>
                                    <tr>
                                        <th>保单费用(元)：</th>
                                        <td><span data-id="bdfy"></span></td>
                                    </tr>
                                    <tr>
                                        <th>货物重量(kg)：</th>
                                        <td><span data-id="hwzl"></span></td>
                                    </tr>
                                    <tr>
                                        <th>货物实际重量：</th>
                                        <td><input type="text" name="hwsjzl" data-id="hwsjzl" required="required" data-parsley-type="number" /></td>
                                    </tr>
                                    <tr>
                                        <th>货物实际体积重量：</th>
                                        <td><input type="text" name="hwsjtjzl" data-id="hwsjtjzl" required="required" data-parsley-type="number" /></td>
                                    </tr>
                                    <tr>
                                        <th>箱子外包装总体积：</th>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            长(cm)：<span data-id="chang"></span>,
                                            宽(cm)：<span data-id="kuan"></span>,
                                            高(cm)：<span data-id="gao"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>订单实际价格 (元)：</th>
                                        <td><input type="text" name="ddsjjg" data-id="ddsjjg" required="required" data-parsley-type="number" /></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="messages1">
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <th style="width: 30%">包裹编号：</th>
                                        <td><span data-id="bgbh"></span></td>
                                    </tr>
                                    <tr>
                                        <th>订单省份：</th>
                                        <td><span data-id="ddsf"></span></td>
                                    </tr>
                                    <tr>
                                        <th>订单详细地址：</th>
                                        <td><span data-id="ddxxdz"></span></td>
                                    </tr>
                                    <tr>
                                        <th>收件人姓名：</th>
                                        <td><span data-id="sjrxm"></span></td>
                                    </tr>
                                    <tr>
                                        <th>收件人电话 ：</th>
                                        <td><span data-id="sjrdh"></span></td>
                                    </tr>
                                    <tr>
                                        <th>打包方式 ：</th>
                                        <td><span data-id="dbfs"></span></td>
                                    </tr>
                                    <tr>
                                        <th>快递方式：</th>
                                        <td><span data-id="kdfs"></span></td>
                                    </tr>
                                    <tr>
                                        <th>货物明细 ：</th>
                                        <td><span data-id="hwmx"></span></td>
                                    </tr>
                                    <tr>
                                        <th>包裹重量(千克)：</th>
                                        <td><span data-id="bgzl"></span></td>
                                    </tr>
                                    <tr>
                                        <th>实际重量(千克)：</th>
                                        <td><input type="text" name="csjzl" data-id="csjzl" required="required" data-parsley-type="number" /></td>
                                    </tr>
                                    <tr>
                                        <th>实际价格(元)：</th>
                                        <td><input type="text" name="csjjg" data-id="csjjg" required="required" data-parsley-type="number" /></td>
                                    </tr>
                                    <tr>
                                        <th>国内快递单号：</th>
                                        <td><span data-id="gnkddh"></span></td>
                                    </tr>
                                    <tr>
                                        <th>备注：</th>
                                        <td><span data-id="bz"></span></td>
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                    </div>
                </form>
                <div class="col-md-offset-3">
                    <button type="button" class="btn btn-success" id="btn-save">确认处理</button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal -->
<div class="modal fade" id="updateModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">订单修改</h4>
            </div>
            <div class="modal-body">
                <div id="alert-infor-edit" class="alert alert-success alert-dismissible" role="alert" style="display: none;">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <strong>错误!</strong>
                    <label></label>
                </div>
                <form class="form-horizontal form-label-left" id="updateform" method="post" action="@Url.Action("UpdateOrder")" enctype="multipart/form-data" data-parsley-validate data-parsley-excluded="input[type=button],input[type=submit],input[type=reset],input[type=hidden],input[type=radio]">
                    <input type="hidden" name="updateorderid" id="updateorderid" />
                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="editgoodsdesc">
                            货物明细
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <input type="file" id="editgoodsdesc" name="editgoodsdesc" class="form-control col-md-7 col-xs-12">
                            <a href="~/ExcelFiles/" target="_blank" id="editgoodsdesclink"></a>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="editguoneidingdanhao">
                            国内订单号
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <input type="text" id="editguoneidingdanhao" name="editguoneidingdanhao" class="form-control col-md-7 col-xs-12">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                            <button type="submit" class="btn btn-success" id="btn-edit">确认修改</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="fahuoModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">发货信息</h4>
            </div>
            <div class="modal-body">
                <div id="alert-infor" class="alert alert-success alert-dismissible" role="alert" style="display: none;">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <strong>错误!</strong>
                    <label></label>
                </div>
                <form class="form-horizontal form-label-left" id="fahuoform" method="post" action="@Url.Action("Filled")" data-parsley-validate data-parsley-excluded="input[type=button],input[type=submit],input[type=reset],input[type=hidden],input[type=radio]">
                    <input type="hidden" name="fahuoid" />
                    @*<div class="form-group">
                            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="gzdh">
                                跟踪单号 <span class="required">*</span>
                            </label>
                            <div class="col-md-6 col-sm-6 col-xs-12">
                                <input type="text" id="gzdh" name="gzdh" required="required" class="form-control col-md-7 col-xs-12">
                            </div>
                        </div>*@
                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="fhsj">
                            发货时间 <span class="required">*</span>
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <input type="text" id="fhsj" name="fhsj" required="required" class="form-control col-md-7 col-xs-12">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="fhnr">
                            发货详情 <span class="required">*</span>
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <textarea type="text" id="fhnr" name="fhnr" class="form-control col-md-7 col-xs-12"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                            <button type="button" class="btn btn-success" id="btn-savef-fahuo">确认发货</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="shoukuanModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">收款信息</h4>
            </div>
            <div class="modal-body">
                <div id="alert-infor" class="alert alert-success alert-dismissible" role="alert" style="display: none;">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <strong>错误!</strong>
                    <label></label>
                </div>
                <form class="form-horizontal form-label-left" id="shoukuanform" method="post" action="@Url.Action("Collection")" data-parsley-validate data-parsley-excluded="input[type=button],input[type=submit],input[type=reset],input[type=hidden],input[type=radio]">
                    <input type="hidden" name="shoukuanid" />
                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="shoukuanshijian">
                            收款时间 <span class="required">*</span>
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <input type="text" id="shoukuanshijian" name="shoukuanshijian" required="required" class="form-control col-md-7 col-xs-12">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="shoukuanxiangqing">
                            收款详情 <span class="required">*</span>
                        </label>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <textarea type="text" id="shoukuanxiangqing" name="shoukuanxiangqing" class="form-control col-md-7 col-xs-12"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                            <button type="button" class="btn btn-success" id="btn-save-shoukuan">确认收款</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<div class="modal fade bs-example-modal-lg" id="fukuanqverenmodel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">付款确认</h4>
            </div>
            <div class="modal-body">
                <div id="payviewList"></div>
            </div>

        </div>
    </div>
</div>
<script src="~/Scripts/parsley.min.js"></script>
<script src="~/Scripts/jquery.form.js"></script>
<script>
    var $table = $('#table'),
        $fahuobtn = $('#fahuobtn'),
        selections = [],
        $ok = $('#ok');
    $(function () {
        $('#orderdate').daterangepicker({
            autoApply: true,
            autoUpdateInput: false,
        });
        $('#orderdate').on('apply.daterangepicker', function (ev, picker) {
            $(this).val(picker.startDate.format('MM/DD/YYYY') + ' - ' + picker.endDate.format('MM/DD/YYYY'));
        });

        $('#orderdate').on('cancel.daterangepicker', function (ev, picker) {
            $(this).val('');
        });
        $('#updateform').ajaxForm({
            resetForm: true,
            error: function (xhr, status, error, $form) {
                $('#alert-infor').removeClass('alert-success');
                $('#alert-infor').addClass('alert-danger');
                $('#alert-infor').show();
                $('#alert-infor label').html(error);
                $('#alert-infor strong').html('错误！');
            },
            success: function (responseText, statusText) {
                //$('#alert-infor').removeClass('alert-danger');
                //$('#alert-infor').addClass('alert-success');
                //$('#alert-infor').show();
                ////$('#alert-infor label').html(error);
                //$('#alert-infor strong').html('Successfully');
                $table.bootstrapTable('refresh');
                $('#updateModel').modal('hide');
            }
        });
        $('#fhsj,#shoukuanshijian')
            .daterangepicker({
                "singleDatePicker": true,
                "locale": {
                    "format": "YYYY-MM-DD"
                }
            });
        $ok.click(function () {
            $table.bootstrapTable('refresh');
        });
        $('[data-toggle="table"]').bootstrapTable();
        $table.on('check.bs.table uncheck.bs.table ' +
            'check-all.bs.table uncheck-all.bs.table',
            function () {
                $fahuobtn.prop('disabled', !$table.bootstrapTable('getSelections').length);

                // save your data, here just save the current page
                selections = getIdSelections();
                // push or splice the selections if you want to save all data selections
            });

        $('[role=complementary] ul.bs-docs-sidenav>li>a')
            .click(function (e) {
                e.stopPropagation();
                e.preventDefault();
                var t = new Date().getTime();
                var href = $(this).attr('href');
                if (href != null && href != "#") {
                    $('body').mLoading("show"); //显示loading组件
                    $('#main-page')
                         .load(href + "?t=" + t,
                            function () {
                                $('body').mLoading("hide"); //显示loading组件
                            });
                }
            });
        $('#btn-save')
            .click(function (e) {
                if ($('#editorderform').parsley().validate() && $('#editorderform').parsley().isValid()) {
                    $('#editorderform')
                        .ajaxSubmit({
                            resetForm: true,
                            error: function (xhr, status, error, $form) {
                                $('#alert-infor').removeClass('alert-success');
                                $('#alert-infor').addClass('alert-danger');
                                $('#alert-infor').show();
                                $('#alert-infor label').html(error);
                                $('#alert-infor strong').html('错误！');
                            },
                            success: function (responseText, statusText) {
                                //$('#alert-infor').removeClass('alert-danger');
                                //$('#alert-infor').addClass('alert-success');
                                //$('#alert-infor').show();
                                ////$('#alert-infor label').html(error);
                                //$('#alert-infor strong').html('Successfully');
                                $table.bootstrapTable('refresh');
                                $('#EditModel').modal('hide');
                            }
                        });
                }
            });
        $('#btn-savef-fahuo')
            .click(function (e) {
                if ($('#fahuoform').parsley().validate() && $('#fahuoform').parsley().isValid()) {
                    $('#fahuoform')
                        .ajaxSubmit({
                            resetForm: true,
                            error: function (xhr, status, error, $form) {
                                $('#alert-infor').removeClass('alert-success');
                                $('#alert-infor').addClass('alert-danger');
                                $('#alert-infor').show();
                                $('#alert-infor label').html(error);
                                $('#alert-infor strong').html('错误！');
                            },
                            success: function (responseText, statusText) {
                                //$('#alert-infor').removeClass('alert-danger');
                                //$('#alert-infor').addClass('alert-success');
                                //$('#alert-infor').show();
                                ////$('#alert-infor label').html(error);
                                //$('#alert-infor strong').html('Successfully');
                                $table.bootstrapTable('refresh');
                                $('#fahuoModel').modal('hide');
                                $('#fahuobtn').prop('disabled');
                            }
                        });
                }
            });
        $('#btn-save-shoukuan')
            .click(function (e) {
                if ($('#shoukuanform').parsley().validate() && $('#shoukuanform').parsley().isValid()) {
                    $('#shoukuanform')
                        .ajaxSubmit({
                            resetForm: true,
                            error: function (xhr, status, error, $form) {
                                $('#alert-infor').removeClass('alert-success');
                                $('#alert-infor').addClass('alert-danger');
                                $('#alert-infor').show();
                                $('#alert-infor label').html(error);
                                $('#alert-infor strong').html('错误！');
                            },
                            success: function (responseText, statusText) {
                                //$('#alert-infor').removeClass('alert-danger');
                                //$('#alert-infor').addClass('alert-success');
                                //$('#alert-infor').show();
                                ////$('#alert-infor label').html(error);
                                //$('#alert-infor strong').html('Successfully');
                                $table.bootstrapTable('refresh');
                                $('#shoukuanModel').modal('hide');
                            }
                        });
                }
            });

        function getIdSelections() {
            return $.map($table.bootstrapTable('getSelections'),
                function (row) {
                    return row.Id;
                });
        }
    });

    function queryParams(params) {
        $('#toolbar')
            .find('input[name],select')
            .each(function () {
                params[$(this).attr('name')] = $(this).val();
            });
        return params;
    }

    function priceFormatter(v, r) { }

    function paystateFormatter(value, row, index) {
        var h = [];
        h.push('<p>到付金额：');
        if (row.IsArrivePay) {
            if (row.ArrivePayStatus === 0) {
                h.push("<code>" + row.ArrivePayValue + '</code> <span class="control-label text-info">（待支付）</span></p>');
            } else if (row.ArrivePayStatus === 1) {
                h.push("<span class='has-success'><code>" + row.ArrivePayValue + '</code> <span class="control-label">（待确认）</span></span></p>');
            } else if (row.ArrivePayStatus === 2) {
                h.push("<code>" + row.ArrivePayValue + '</code>（已确认）</p>');
                //h.push('<br><a class="btn btn-success btn-xs" target="_blank" href="@Url.Action("PayOrder")?id=' + row.Id + '">付款完成</a>');
            }
        } else {
            h.push('无到付</p>');
        }
        if (value == 1) {
            h.push('<span  class="text-warning">处理中</span>');
            return h.join('');
        }
        h.push('<p>国际费用：');
        if (row.WorldPayStatus === 0) {
            h.push("<code>" + row.OrderFrees + '</code> <span class="control-label text-info">（待支付）</span></p>');
        } else if (row.WorldPayStatus === 1) {
            h.push("<span class='has-success'><code>" + row.OrderFrees + '</code> <span class="control-label">（待确认）</span></span></p>');
        } else if (row.WorldPayStatus === 2) {
            h.push("<code>" + row.OrderFrees + '</code>（已确认）</p>');
            //h.push('<br><a class="btn btn-success btn-xs" target="_blank" href="@Url.Action("PayOrder")?id=' + row.Id + '">付款完成</a>');
        }
        h.push('<p>国内费用：');
        if (row.ChinaPayStatus === 0) {
            h.push("<code>" + row.DomesticCost + '</code> <span class="control-label text-info">（待支付）</span></p>');
        } else if (row.ChinaPayStatus === 1) {
            h.push("<span class='has-success'><code>" + row.DomesticCost + '</code> <span class="control-label">（待确认）</span></span></p>');
        } else if (row.ChinaPayStatus === 2) {
            h.push("<code>" + row.DomesticCost + '</code>（已确认）</p>');
            //h.push('<br><a class="btn btn-success btn-xs" target="_blank" href="@Url.Action("PayOrder")?id=' + row.Id + '">付款完成</a>');
        }

        return h.join('');
        // return Status_7077.getPayStatus(row.PayStatus);
    }
    function OrderNoFormatter(value, row, index) {
        return '<a href="javascript:void(0)" onclick="viewOrder(' +
                JSON.stringify(row).replace(/\"/g, "\'") +
                ')">' + value + '</a>';
    }
    function stateFormatter(value, row, index) {
        return Status_7077.getOrderStatus(row.Status);
    }

    function checkboxstateFormatter(value, row, index) {
        if (row.IsArrivePay && row.ArrivePayStatus != 2) {
            return {
                disabled: true
            };
        }
        if (row.Status < 1 || row.Status >= 8) {
            return {
                disabled: true
            };
        }
        return value;
    }

    function actionFormatter(value, row, index) {
        var h = [];
        if (row.Status < 9 && row.Status > 0)
            h.push('<button  type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#updateModel" onclick="updatedate(' +
                    JSON.stringify(row).replace(/\"/g, "\'") +
                    ')" value="">修改</button>');
        if (row.Status <= 2 && row.Status > 0 && '@ViewBag.Role' == 'Agents' && (row.WorldPayStatus == 0 && row.ChinaPayStatus == 0))
            h
                .push(' <button  type="button" class="btn btn-success btn-xs" onclick="editdate(' +
                    JSON.stringify(row).replace(/\"/g, "\'") +
                    ')" value="">处理</button>');

        if ('@ViewBag.Role' == 'Admin' && (row.ArrivePayStatus == 1 || row.WorldPayStatus == 1 || row.ChinaPayStatus == 1))
            h.push(' <button  type="button" class="btn btn-primary btn-xs"  data-toggle="modal" data-target="#fukuanqverenmodel" onclick="fukuanqveren(' +
               JSON.stringify(row).replace(/\"/g, "\'") +
                ')" value="">收款确认</button>');

        @*if (row.Status >= 2 && row.PayStatus >= 1 && row.PayStatus <= 2 && '@ViewBag.Role' == 'Admin')
            h
                .push(' <button  type="button" class="btn btn-warning btn-xs"  data-toggle="modal" data-target="#shoukuanModel" onclick="shoukuandate(' +
                    JSON.stringify(row).replace(/\"/g, "\'") +
                    ')" value="">收款</button>');*@
        if (row.Status < 9 && row.Status > 0 && row.PayStatus == 3 && '@ViewBag.Role' == 'Admin')
            h.push(' <button  type="button" class="btn btn-success btn-xs"  onclick="Completedate(' +
                    JSON.stringify(row).replace(/\"/g, "\'") +
                    ')" value="">完成</button>');
        return h.join('');
    }
    function fukuanqveren(row) {
        var t = new Date().getTime();
        $('#payviewList').load('@Url.Action("PayViewList")?t=' + t + '&orderid=' + row.Id, function () {

        });
    }
    function Completedate(row) {
        if (confirm('确认订单已完成'))
            $.post('@Url.Action("Complete")', { id: row.Id }, function (e) {
                $table.bootstrapTable('refresh');
            });
    }
    function viewOrder(row) {
        $('body').mLoading("show"); //显示loading组件
        var t = new Date().getTime();
        $('.maincontent').load('@Url.Action("OrderView")?t=' + t + '&id=' + row.Id, function (e) {
            $('body').mLoading("hide"); //显示loading组件
        });
    }
    function updatedate(row) {
        $('#editgoodsdesclink').prop('href', '~/ExcelFiles/' + row.GoodsDesc);
        $('#editgoodsdesclink').html(row.GoodsDesc);
        $('#editguoneidingdanhao').val(row.ChinaCourierNumber);
        $('#updateorderid').val(row.Id);
        //$('#orderno').html(row.OrderNo);
        //$('#jjxm').html(row.ShipperName);
        //$('#jjdh').html(row.ShipperPhone);
        //$('#shrshl').html(row.PickupNumber);
        //$('#xdr').html(row.DisplayName);
        //$('#ddzt').html(Status_7077.getOrderStatus(row.Status));
        //$('#xdsj').html(row.CreateDate);
        //$('#elscs').html(row.RussiaCityName);
        //$('#elsdz').html(row.RussiaAddress);
        //$('#wldh').html(row.LogisticsSingle);
        //$('#hwxs').html(row.CargoNumber);
        //$('#qhsj').html(row.PickupDate);
        //$('#qhfs').html(Status_7077.getPickupWay(row.PickupWay));
        //$('#hwlx').html(Status_7077.getGoodsType(row.GoodsType));
        //$('#hwyslx').html(Status_7077.getCargoTransWay(row.TransportationWay));
        //$('#bjjg').html(row.ProtectPrice);
        //$('#bdfy').html(row.PolicyFee);
        //$('#hwzl').html(row.GoodsWeight);
        //$('#chang').html(row.BoxLong);
        //$('#kuan').html(row.BoxWidth);
        //$('#gao').html(row.BoxHeight);
        //$('#bgbh').html(row.ParcelSingle);
        //$('#ddsf').html(row.ChinaCityId);
        //$('#ddxxdz').html(row.ChinaAddress);
        //$('#sjrxm').html(row.ReceiverName);
        //$('#sjrdh').html(row.ReceiverPhone);
        //$('#dbfs').html(Status_7077.getPackagingType(row.PackagingWay));
        //$('#kdfs').html(Status_7077.getExpressWay(row.ExpressWay));
        //$('#hwmx').html(row.GoodsDesc);
        //$('#bgzl').html(row.ParcelWeight);
        //$('#gnkddh').html(row.ChinaCourierNumber);
        //$('#bz').html(row.Desc);
        //$('#orderId').html(row.Id);
        //$('#sjjg').html(row.OrderRealPrice);
        //$('#hwsjzl').html(row.GoodsRealWeight);
        //$('#hwsjtjzl').html(row.GoodsVolumeWeight);
        //$('#ddsjjg').html(row.AddressRealPrice);
        //$('#csjzl').html(row.RealWeight);
        //$('#csjjg').html(row.RealPrice);
        //$('#fkzt').html(Status_7077.getPackagingType(row.PayStatus));
    }

    function editdate(row) {
        $('body').mLoading("show"); //显示loading组件
        var t = new Date().getTime();
        $('.maincontent').load('@Url.Action("EditOrder")?t=' + t + '&id=' + row.Id, function (e) {
            $('body').mLoading("hide"); //显示loading组件
        });
        //$('[data-id=orderno]').html(row.OrderNo);
        //$('[data-id=jjxm]').html(row.ShipperName);
        //$('[data-id=jjdh]').html(row.ShipperPhone);
        //$('[data-id=shrshl]').html(row.PickupNumber);
        //$('[data-id=xdr]').html(row.DisplayName);
        //$('[data-id=ddzt]').html(Status_7077.getOrderStatus(row.Status));
        //$('[data-id=xdsj]').html(row.CreateDate);
        //$('[data-id=elscs]').html(row.RussiaCityName);
        //$('[data-id=elsdz]').html(row.RussiaAddress);
        //$('[data-id=wldh]').html(row.LogisticsSingle);
        //$('[data-id=hwxs]').html(row.CargoNumber);
        //$('[data-id=qhsj]').html(row.PickupDate);
        //$('[data-id=qhfs]').html(Status_7077.getPickupWay(row.PickupWay));
        //$('[data-id=hwlx]').html(Status_7077.getGoodsType(row.GoodsType));
        //$('[data-id=hwyslx]').html(Status_7077.getCargoTransWay(row.TransportationWay));
        //$('[data-id=bjjg]').html(row.ProtectPrice);
        //$('[data-id=bdfy]').html(row.PolicyFee);
        //$('[data-id=hwzl]').html(row.GoodsWeight);
        //$('[data-id=chang]').html(row.BoxLong);
        //$('[data-id=kuan]').html(row.BoxWidth);
        //$('[data-id=gao]').html(row.BoxHeight);
        //$('[data-id=bgbh]').html(row.ParcelSingle);
        //$('[data-id=ddsf]').html(row.ChinaCityId);
        //$('[data-id=ddxxdz]').html(row.ChinaAddress);
        //$('[data-id=sjrxm]').html(row.ReceiverName);
        //$('[data-id=sjrdh]').html(row.ReceiverPhone);
        //$('[data-id=dbfs]').html(Status_7077.getPackagingType(row.PackagingWay));
        //$('[data-id=kdfs]').html(Status_7077.getExpressWay(row.ExpressWay));
        //$('[data-id=hwmx]').html(row.GoodsDesc);
        //$('[data-id=bgzl]').html(row.ParcelWeight);
        //$('[data-id=gnkddh]').html(row.ChinaCourierNumber);
        //$('[data-id=bz]').html(row.Desc);

        //$('[name=orderId]').val(row.Id);
        //$('[name=sjjg]').val(row.OrderRealPrice);
        //$('[name=hwsjzl]').val(row.GoodsRealWeight);
        //$('[name=hwsjtjzl]').val(row.GoodsVolumeWeight);
        //$('[name=ddsjjg]').val(row.AddressRealPrice);
        //$('[name=csjzl]').val(row.RealWeight);
        //$('[name=csjjg]').val(row.RealPrice);
    }

    function fahuodate(row) {
        var ids = getIdSelections();
        $('[name=fahuoid]').val(ids.join(','));
    }
    function getIdSelections() {
        return $.map($table.bootstrapTable('getSelections'),
            function (row) {
                return row.Id;
            });
    }
    function shoukuandate(row) {
        $('[name=shoukuanid]').val(row.Id);
    }
</script>